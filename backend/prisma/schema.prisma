generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum ProductCategory {
  IPHONE
  AIRPODS
  IPAD
  MAC
  WATCH
  ACCESSORY
  OTHER
}

enum Condition {
  NEW
  LIKE_NEW
  USED
}

enum ContactMethod {
  WHATSAPP
  TELEGRAM
  CALL
}

enum DeliveryType {
  MOSCOW
  RUSSIA
  PICKUP
}

enum OrderStatus {
  NEW
  IN_PROGRESS
  DONE
  CANCELED
}

model Product {
  id               Int              @id @default(autoincrement())
  slug             String           @unique
  name             String
  category         ProductCategory
  brand            String
  priceCurrent     Int
  priceOld         Int?
  memory           String
  color            String
  condition        Condition
  isAvailable      Boolean          @default(true)
  shortDescription String
  fullDescription  String
  mainImageUrl     String
  gallery          String[]
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
  orderItems       OrderItem[]
}

model Order {
  id             Int            @id @default(autoincrement())
  customerName   String
  phone          String
  email          String?
  contactMethod  ContactMethod
  deliveryType   DeliveryType
  city           String?
  addressLine    String?
  apartment      String?
  comment        String?
  status         OrderStatus    @default(NEW)
  totalAmount    Int
  createdAt      DateTime       @default(now())
  items          OrderItem[]
}

model OrderItem {
  id        Int     @id @default(autoincrement())
  order     Order   @relation(fields: [orderId], references: [id])
  orderId   Int
  product   Product @relation(fields: [productId], references: [id])
  productId Int
  price     Int
  quantity  Int
}
